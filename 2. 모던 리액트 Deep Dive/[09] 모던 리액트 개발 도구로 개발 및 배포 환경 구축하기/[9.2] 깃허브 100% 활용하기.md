## 2 깃허브 100% 활용하기

<br/>

### 1. 깃허브 액션으로 CI 환경 구축하기

- CI(Continuous Integration) : 코드의 변화를 모으고 관리하는 중앙 저장소에서 여러 기여자가 기여한 코드를 지속적으로 빌드하고 테스트해 코드의 정합성을 확인하는 과정
- CI의 핵심은 코드의 변화가 있을 때마다 정합성을 확인하기 위한 작업을 **자동으로 실행**해야 하는것이다. (테스트, 빌드, 정적 분석, 보안 취약점 분석)
- 깃허브 액션: 깃허브 저장소를 기반으로 깃허브에 발생하는 다양한 이벤트를 트리거 삼아 다양한 작업을 할 수 있게 도와주는 것
    - 깃허브의 어떤 브랜치에 푸시가 발생하면 빌드를 수행한다.
    - 깃허브의 특정 브랜치가 메인 브랜치를 대상으로 풀 리퀘스트가 열리면 빌드, 테스트, 정적 분석을 수행한다.
- 즉, 깃허브 액션이란 다양한 이벤트를 기반으로 깃허브에서 제공하는 가상 환경에서 사용자가 원하는 작업을 수행하도록 도와주는 서비스 → CI/CD 서비스로서 각광받음

<br/>

**깃허브 액션의 기본 개념**

- runner: 파일로 작성된 깃허브 액션이 실행되는 서버를 의미.
- action: 러너에서 실행되는 하나의 작업 단위. yaml 파일로 작성된 내용을 하나의 액션으로 볼 수 있다.
- event: 깃허브 액션의 실행을 일으키는 이벤트를 의미. 개발자의 필요에 따라 한개 이상의 이벤트를 지정 가능, 특정 브랜치를 지정하는 이벤트도 가능
    - pull_request: PR과 관련된 이벤트
    - issues: 이슈와 관련된 이벤트
    - push: 커밋이나 태그가 푸시될 때 발생하는 이벤트
    - schedule: 저장소에서 발생하는 이벤트와 별개로 특정 시간에 실행되는 이벤트. 여기서 시간이란 cron에서 사용되는 시간을 의미
        
        → cron이란 유닉스 계열 운영체제에서 실행되는 시간 기반 잡 스케줄러
        
    - jobs: 하나의 러너에서 실행되는 여러 스텝의 모음. 하나의 액션에서 여러 잡을 생성할 수 있으며 특별한게 없다면 내부 가상머신에서 병렬로 실행
    - steps: 잡 내부에서 일어나는 작업의 단위. 이 작업은 병렬로 일어나지 않음

→ 스텝들을 엮어서 잡을 만들고, 여러 개의 잡은 병렬로 실행되며 이러한 잡을 하나 이상 모아둔 것을 액션이라고 한다. 이 액션을 실행시키는 것이 러너임

<br/>

**깃허브 액션 작성**

- name: 액션의 이름, 필수 값은 아니지만 지정하는 것이 좋음
- run-name: 액션이 실행될 때 구별할 수 있는 타이틀명. 필수 값 아님
- on: 필수 값으로, 언제 이 액션을 실행할지 정의한다. 자세한 옵션은 깃 허브 문서를 참고
- jobs: 필수값으로, 해당 액션에서 수행할 잡을 의미. 한 개 이상 설정 가능하며 여러 개 일경우 병렬로 실행
- 깃허브 액션을 적절히 활용하면 다양한 작업을 할 수 있음
    - 깃허브 API를 직접 호출해 깃허브 풀 리퀘스트에 댓글 달기
    - 일정 시간마다 특정한 작업을 수행
    - 배포 서비스와 연동해 자동으로 배포 실행
    - 저장소 내부에 이미지가 추가될 때마다 최적화 등
<br/>

### 2. 직접 작성하지 않고 유용한 액션과 깃허브 앱 가져다 쓰기

- marketplaces라는 서비스를 제공해 여러 사용자가 만들어 놓은 액션을 가져다 쓸 수 있도록 운영

**깃허브 기본 액션**

- actions/checkout: 깃허브 저장소를 체크아웃 하는 액션. 저장소를 기반으로 작업해야 한다면 반드시 필요하며 해당 액션을 트리거한 최신 커밋을 불러온다.
- actions/setup-node: Node.js를 설치하는 액션이며 Node.js를 사용하는 프로젝트라면 반드시 필요하다.
- actions/github-script: GitHub API가 제공하는 기능을 사용할 수 있도록 도와주는 액션. API 문서를 참고하자
- actions/stale: 오래된 이슈나 PR를 자동으로 닫아 더이상 커뮤니케이션 못하도록 함.
- actions/dependency-review-action: 의존성 그래프에 대한 변경, 즉 package.json, package-lock.json, pnpm.lock.yaml등의 내용이 변경되었을 때 실행되는 액션으로 의존성을 분석해 보안 또는 라이선스를 알려줌
- github/codeql-action: 깃허브의 코드 분석 솔루션인 code-ql을 활용해 저장소 내 코드의 취약점을 분석. languages에 javascript만 설정해 두면 자바스크립트와 타입스크립트를 모두 검사

<br/>

### 3. 깃허브 Dependabot으로 보안 취약점 해결하기

- Dependabot는 의존성에 문제가 있다면 이를 해결 가능한 풀 리퀘스트를 열어줌

<br/>
  

**의존성**

- npm 프로젝트를 운영하는 데 필요한 자신 외의 npm 라이브러리를 정의해 둔 목록
- JSON 형식으로 작성되어 있으며, 주로 dependencies와 devDependencies로 구성
    - dependencies: 프로젝트를 실행하는 데 필요한 패키지
    - devDependencies: 프로젝트를 실행하는 데 필요하지 않지만 개발 단계에서 필요한 패키지

<br/>


**Dependabot로 취약점 해결하기**

- 취약점이 발견된다면 PR 후 원격 저장소에 관련 배너가 뜨는데, See Dependabot alerts 버튼을 눌러 확인할 수 있음
- 취약점을 가장 쉽게 해결할 수 있는 방법은 Dependabot이 풀 리퀘스트를 열어준 경우이다.
- 풀 리퀘스트를 열어준 다는 것은 취약점을 해결한 패키지가 존재한 다는 것을 의미하며 관련된 다른 패키지의 버전과 의존성에 유의하며 해당 버전을 변경한다.
